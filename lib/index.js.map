{"version":3,"file":"index.js","sources":["../src/index.js"],"sourcesContent":["/* @flow */\n\nimport * as React from 'react';\nimport { findDOMNode } from 'react-dom';\nimport Draggable from 'react-draggable-rotate';\nimport Resizable from 're-resizable-rotate';\nimport type { ResizeDirection, ResizeCallback, ResizeStartCallback } from 're-resizable-rotate';\n\n// console.log('Draggable', Draggable.DraggableAlignGuide);\nexport type Grid = [number, number];\n\nexport type Position = {\n  x: number;\n  y: number;\n}\n\nexport type DraggableData = {\n  node: HTMLElement;\n  deltaX: number, deltaY: number;\n  lastX: number, lastY: number;\n} & Position;\n\nexport type RndDragCallback = (\n  e: Event, data: DraggableData,\n) => void | false;\n\nexport type RndResizeStartCallback = (\n  e: SyntheticMouseEvent<HTMLDivElement> | SyntheticTouchEvent<HTMLDivElement>,\n  dir: ResizeDirection,\n  refToElement: React.ElementRef<'div'>,\n) => void;\n\nexport type ResizableDelta = {\n  width: number, height: number,\n}\n\nexport type RndResizeCallback = (\n  e: MouseEvent | TouchEvent,\n  dir: ResizeDirection,\n  refToElement: React.ElementRef<'div'>,\n  delta: ResizableDelta,\n  position: Position,\n) => void;\n\ntype Size = {\n  width: string | number;\n  height: string | number;\n}\n\ntype State = {\n  disableDragging: boolean;\n  z?: number;\n  original: Position;\n  bounds: {\n    top: number;\n    right: number;\n    bottom: number;\n    left: number;\n  };\n  maxWidth?: number | string;\n  maxHeight?: number | string;\n  isMounted: boolean;\n}\n\nexport type ResizeEnable = {\n  bottom?: boolean,\n  bottomLeft?: boolean,\n  bottomRight?: boolean,\n  left?: boolean,\n  right?: boolean,\n  top?: boolean,\n  topLeft?: boolean,\n  topRight?: boolean\n}\n\nexport type HandleClasses = {\n  bottom?: string,\n  bottomLeft?: string,\n  bottomRight?: string,\n  left?: string,\n  right?: string,\n  top?: string,\n  topLeft?: string,\n  topRight?: string\n}\n\ntype Style = {\n  [key: string]: string | number;\n}\n\nexport type HandleStyles = {\n  bottom?: Style,\n  bottomLeft?: Style,\n  bottomRight?: Style,\n  left?: Style,\n  right?: Style,\n  top?: Style,\n  topLeft?: Style,\n  topRight?: Style\n}\n\ntype Props = {\n  z?: number;\n  dragGrid?: Grid;\n  default?: {\n    x: number;\n    y: number;\n  } & Size;\n  position?: {\n    x: number;\n    y: number;\n  };\n  size?: Size;\n  resizeGrid?: Grid;\n  bounds?: string;\n  onResizeStart?: RndResizeStartCallback;\n  onResize?: RndResizeCallback;\n  onResizeStop?: RndResizeCallback;\n  onDragStart?: RndDragCallback;\n  onDrag?: RndDragCallback;\n  onDragStop?: RndDragCallback;\n  onMoveSnap?: any;\n  onKeyUp?: any;\n  onKeyDown?: any;\n  onKeyMove?: any;\n  className?: string;\n  style?: Style;\n  children?: React.Node;\n  enableResizing?: ResizeEnable;\n  extendsProps?: { [key: string]: any };\n  resizeHandleClasses?: HandleClasses;\n  resizeHandleStyles?: HandleStyles;\n  resizeHandleWrapperClass?: string;\n  resizeHandleWrapperStyle?: Style;\n  lockAspectRatio?: boolean;\n  maxHeight?: number | string;\n  maxWidth?: number | string;\n  minHeight?: number | string;\n  minWidth?: number | string;\n  keyMoveShiftStepLength?: number;\n  dragAxis?: 'x' | 'y' | 'both' | 'none';\n  dragHandleClassName?: string;\n  disableDragging?: boolean;\n  _freeBottomBounds?: boolean; // Back door for react-elastic-grid.\n}\n\nconst resizableStyle = {\n  width: 'auto',\n  height: 'auto',\n  display: 'inline-block',\n  position: 'absolute',\n  top: 0,\n  left: 0,\n};\n\nexport default class Rnd extends React.Component<Props, State> {\n  static defaultProps = {\n    maxWidth: Number.MAX_SAFE_INTEGER,\n    maxHeight: Number.MAX_SAFE_INTEGER,\n    keyMoveShiftStepLength: 10,\n    onResizeStart: () => { },\n    onResize: () => { },\n    onResizeStop: () => { },\n    onDragStart: () => { },\n    onDrag: () => { },\n    onDragStop: () => { },\n    onMoveSnap: () => { },\n    onKeyUp: () => { },\n    onKeyDown: () => { },\n    onKeyMove: () => { }\n  };\n  resizable: (React$ElementRef<typeof Resizable> | null);\n  draggable: Draggable;\n  onResizeStart: ResizeStartCallback;\n  onResize: ResizeCallback;\n  onResizeStop: ResizeCallback;\n  onDragStart: RndDragCallback;\n  onDrag: RndDragCallback;\n  onDragStop: RndDragCallback;\n  onMoveSnap: any;\n  onKeyUp: any;\n  onKeyDown: any;\n  onKeyMove: any;\n  getMaxSizesFromProps: () => ({\n    maxWidth: number | string;\n    maxHeight: number | string;\n  });\n  wrapper: HTMLElement;\n  parentId: string;\n\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      disableDragging: false,\n      z: props.z,\n      original: {\n        x: 0,\n        y: 0,\n      },\n      bounds: {\n        top: 0,\n        right: 0,\n        bottom: 0,\n        left: 0,\n      },\n      maxWidth: props.maxWidth,\n      maxHeight: props.maxHeight,\n      isMounted: false,\n    };\n    this.degree = props.degree || 0;\n    this.onResizeStart = this.onResizeStart.bind(this);\n    this.onResize = this.onResize.bind(this);\n    this.onResizeStop = this.onResizeStop.bind(this);\n    this.onDragStart = this.onDragStart.bind(this);\n    this.onDrag = this.onDrag.bind(this);\n    this.onDragStop = this.onDragStop.bind(this);\n    this.getMaxSizesFromProps = this.getMaxSizesFromProps.bind(this);\n    this.onMoveSnap = this.onMoveSnap.bind(this);\n    this.onKeyUp = this.onKeyUp.bind(this);\n    this.onKeyDown = this.onKeyDown.bind(this);\n    this.onKeyMove = this.onKeyMove.bind(this);\n  }\n\n  componentWillReceiveProps(nextProps: Props) {\n    if (this.props.z !== nextProps.z) {\n      this.setState({ z: nextProps.z });\n    }\n  }\n\n  componentDidMount() {\n    this.setParentPosition();\n  }\n\n  getParentSize(): { width: number, height: number } {\n    return (this.resizable: any).getParentSize();\n  }\n\n  getMaxSizesFromProps(): { maxWidth: number | string; maxHeight: number | string } {\n    const maxWidth = typeof this.props.maxWidth === 'undefined' ? Number.MAX_SAFE_INTEGER : this.props.maxWidth;\n    const maxHeight = typeof this.props.maxHeight === 'undefined' ? Number.MAX_SAFE_INTEGER : this.props.maxHeight;\n    return { maxWidth, maxHeight };\n  }\n\n  getSelfElement(): null | Element | Text {\n    if (!this) return null;\n    return findDOMNode(this);\n  }\n\n  setParentPosition() {\n    const element = this.getSelfElement();\n    if (element instanceof Element) {\n      const parent = element.parentNode;\n      if (!parent || typeof window === 'undefined') return;\n      if (!(parent instanceof HTMLElement)) return;\n      if (getComputedStyle(parent).position !== 'static') {\n        this.setState({ isMounted: true });\n        return;\n      }\n      parent.style.position = 'relative';\n      this.setState({ isMounted: true });\n    }\n  }\n\n  onDragStart(e: Event, data: DraggableData) {\n    if (this.props.onDragStart) {\n      data.degree = this.degree\n      this.props.onDragStart(e, data);\n    }\n    if (!this.props.bounds) return;\n    const parent = this.resizable && this.resizable.parentNode;\n    const target = this.props.bounds === 'parent'\n      ? parent\n      : document.querySelector(this.props.bounds);\n    if (!(target instanceof HTMLElement) || !(parent instanceof HTMLElement)) return;\n    const targetRect = target.getBoundingClientRect();\n    const targetLeft = targetRect.left;\n    const targetTop = targetRect.top;\n    const parentRect = parent.getBoundingClientRect();\n    const parentLeft = parentRect.left;\n    const parentTop = parentRect.top;\n    const left = targetLeft - parentLeft;\n    const top = targetTop - parentTop;\n    if (!this.resizable) return;\n    this.setState({\n      bounds: {\n        top,\n        right: left + (target.offsetWidth - this.resizable.size.width),\n        bottom: this.props._freeBottomBounds // eslint-disable-line\n          ? 2147483647\n          : top + (target.offsetHeight - this.resizable.size.height),\n        left,\n      },\n    });\n  }\n\n  onDrag(e: Event, data: DraggableData) {\n    if (this.props.onDrag) {\n      data.degree = this.degree\n      if (this.resizable) {\n        data.newWidth = this.resizable.size.width\n        data.newHeight = this.resizable.size.height\n      }\n      this.props.onDrag(e, data);\n    }\n  }\n\n  onDragStop(e: Event, data: DraggableData) {\n    if (this.props.onDragStop) {\n      data.degree = this.degree\n      if (this.resizable) {\n        data.newWidth = this.resizable.size.width\n        data.newHeight = this.resizable.size.height\n      }\n      this.props.onDragStop(e, data);\n    }\n  }\n\n  onMoveSnap(data: any) {\n    if (this.props.onMoveSnap) {\n      data.degree = this.degree\n\n      this.props.onMoveSnap(data);\n    }\n  }\n  onKeyUp(e: Event) {\n    if (this.props.onKeyUp) {\n      this.props.onKeyUp(e, this);\n    }\n  }\n  onKeyDown(e: Event) {\n    if (this.props.onKeyDown) {\n      this.props.onKeyDown(e, this);\n    }\n  }\n  onKeyMove(e: Event, data: any) {\n    if (this.props.onKeyMove) {\n      this.props.onKeyMove(e, data, this);\n    }\n  }\n  onResizeStart(\n    e: SyntheticMouseEvent<HTMLDivElement> | SyntheticTouchEvent<HTMLDivElement>,\n    dir: ResizeDirection,\n    refToElement: React.ElementRef<'div'>,\n  ) {\n    e.stopPropagation();\n    this.setState({\n      disableDragging: true,\n      original: { x: this.draggable.state.x, y: this.draggable.state.y },\n    });\n    if (this.props.bounds) {\n      const parent = this.resizable && this.resizable.parentNode;\n      const target = this.props.bounds === 'parent'\n        ? parent\n        : document.querySelector(this.props.bounds);\n      const self = this.getSelfElement();\n      if (self instanceof Element && target instanceof HTMLElement && parent instanceof HTMLElement) {\n        let { maxWidth, maxHeight } = this.getMaxSizesFromProps();\n        const parentSize = this.getParentSize();\n        if (maxWidth && typeof maxWidth === 'string') {\n          if (maxWidth.endsWith('%')) {\n            const ratio = Number(maxWidth.replace('%', '')) / 100;\n            maxWidth = parentSize.width * ratio;\n          } else if (maxWidth.endsWith('px')) {\n            maxWidth = Number(maxWidth.replace('px', ''));\n          }\n        }\n        if (maxHeight && typeof maxHeight === 'string') {\n          if (maxHeight.endsWith('%')) {\n            const ratio = Number(maxHeight.replace('%', '')) / 100;\n            maxHeight = parentSize.width * ratio;\n          } else if (maxHeight.endsWith('px')) {\n            maxHeight = Number(maxHeight.replace('px', ''));\n          }\n        }\n        const selfRect = self.getBoundingClientRect();\n        const selfLeft = selfRect.left;\n        const selfTop = selfRect.top;\n        const targetRect = target.getBoundingClientRect();\n        const targetLeft = targetRect.left;\n        const targetTop = targetRect.top;\n        if (/left/i.test(dir) && this.resizable) {\n          const max = (selfLeft - targetLeft) + this.resizable.size.width;\n          this.setState({ maxWidth: max > Number(maxWidth) ? maxWidth : max });\n        }\n        if (/right/i.test(dir)) {\n          const max = target.offsetWidth + (targetLeft - selfLeft);\n          this.setState({ maxWidth: max > Number(maxWidth) ? maxWidth : max });\n        }\n        if (/top/i.test(dir) && this.resizable) {\n          const max = (selfTop - targetTop) + this.resizable.size.height;\n          this.setState({ maxHeight: max > Number(maxHeight) ? maxHeight : max });\n        }\n        if (/bottom/i.test(dir)) {\n          const max = target.offsetHeight + (targetTop - selfTop);\n          this.setState({ maxHeight: max > Number(maxHeight) ? maxHeight : max });\n        }\n      }\n    } else {\n      this.setState({ maxWidth: this.props.maxWidth, maxHeight: this.props.maxHeight });\n    }\n    if (this.props.onResizeStart) {\n      this.props.onResizeStart(e, dir, refToElement);\n    }\n  }\n\n  onResize(\n    e: MouseEvent | TouchEvent,\n    direction: ResizeDirection,\n    refToResizableElement: React.ElementRef<'div'>,\n    delta: { height: number, width: number },\n  ) {\n    let x;\n    let y;\n\n    if (/left/i.test(direction)) {\n      x = this.state.original.x - delta.width;\n      this.draggable.setState({ x });\n    }\n    if (/top/i.test(direction)) {\n      y = this.state.original.y - delta.height;\n      this.draggable.setState({ y });\n    }\n    if (this.props.onResize) {\n      delta.degree = delta.degree || this.degree\n      this.props.onResize(\n        e,\n        direction,\n        refToResizableElement,\n        delta,\n        {\n          x: x || this.draggable.state.x,\n          y: y || this.draggable.state.y,\n        });\n    }\n  }\n\n  onResizeStop(\n    e: MouseEvent | TouchEvent,\n    direction: ResizeDirection,\n    refToResizableElement: HTMLDivElement,\n    delta: { height: number, width: number },\n  ) {\n    const { maxWidth, maxHeight } = this.getMaxSizesFromProps();\n    this.setState({ disableDragging: false, maxWidth, maxHeight });\n    if (this.props.onResizeStop) {\n      const position: Position = {\n        x: this.draggable.state.x,\n        y: this.draggable.state.y,\n      };\n      delta.degree = delta.degree || this.degree\n      this.props.onResizeStop(e, direction, refToResizableElement, delta, position);\n    }\n  }\n\n  updateSize(size: { width: number | string, height: number | string, degree: number | string }) {\n    if (!this.resizable) return;\n    this.resizable.updateSize({ width: size.width, height: size.height, degree: size.degree });\n  }\n\n  updatePosition(position: Position) {\n    this.draggable.setState(position);\n  }\n\n  updateMoveSnap(snap: any) {\n    this.draggable.moveSnaping(snap);\n  }\n\n  updateZIndex(z: number) {\n    this.setState({ z });\n  }\n  render(): React.Node {\n    const cursorStyle = this.props.disableDragging || this.props.dragHandleClassName\n      ? { cursor: 'normal' }\n      : { cursor: 'move' };\n    const innerStyle = {\n      ...resizableStyle,\n      zIndex: this.state.z,\n      ...cursorStyle,\n      ...this.props.style,\n    };\n    // HACK: Wait for setting relative to parent element.\n    if (!this.state.isMounted) return <div />;\n    const maxHeight = this.props._freeBottomBounds ? 2147483647 : this.state.maxHeight; // eslint-disable-line\n    let degree = 0;\n    if (this.resizable && this.resizable.degree) {\n      degree = this.resizable.degree;\n      this.degree = degree;\n    } else if (this.props.default) {\n      degree = this.props.default.degree;\n      this.degree = degree;\n    }\n    let position = { x: 0, y: 0 };\n    if (this.draggable && this.draggable.positionRotate) {\n      position = this.draggable.positionRotate;\n    }\n    // console.log('position,degree', position, degree, this.props.position);\n    return (\n      <Draggable\n        ref={(c: Draggable) => { this.draggable = c; }}\n        handle={this.props.dragHandleClassName}\n        defaultPosition={this.props.default}\n        onStart={this.onDragStart}\n        onDrag={this.onDrag}\n        onStop={this.onDragStop}\n        onMoveSnap={this.onMoveSnap}\n        onKeyUp={this.onKeyUp}\n        onKeyDown={this.onKeyDown}\n        onKeyMove={this.onKeyMove}\n        axis={this.props.dragAxis}\n        disabled={this.props.disableDragging}\n        grid={this.props.dragGrid}\n        bounds={this.props.bounds ? this.state.bounds : undefined}\n        position={this.props.position}\n        enableUserSelectHack={false}\n        degree={degree}\n        keyMoveShiftStepLength={this.props.keyMoveShiftStepLength}\n      >\n        <Resizable\n          {...this.props.extendsProps}\n          className={this.props.className}\n          ref={(c: (React$ElementRef<typeof Resizable> | null)) => {\n            this.resizable = c;\n          }}\n          defaultSize={this.props.default}\n          size={this.props.size}\n          position={position}\n          enable={this.props.enableResizing}\n          onResizeStart={this.onResizeStart}\n          onResize={this.onResize}\n          onResizeStop={this.onResizeStop}\n          style={innerStyle}\n          minWidth={this.props.minWidth}\n          minHeight={this.props.minHeight}\n          maxWidth={this.state.maxWidth}\n          maxHeight={maxHeight}\n          grid={this.props.resizeGrid}\n          handleWrapperClass={this.props.resizeHandleWrapperClass}\n          handleWrapperStyle={this.props.resizeHandleWrapperStyle}\n          lockAspectRatio={this.props.lockAspectRatio}\n          handleStyles={this.props.resizeHandleStyles}\n          handleClasses={this.props.resizeHandleClasses}\n        >\n          {this.props.children}\n        </Resizable>\n      </Draggable >\n    );\n  }\n}\n"],"names":["resizableStyle","Rnd","props","state","z","maxWidth","maxHeight","degree","onResizeStart","bind","onResize","onResizeStop","onDragStart","onDrag","onDragStop","getMaxSizesFromProps","onMoveSnap","onKeyUp","onKeyDown","onKeyMove","nextProps","setState","setParentPosition","resizable","getParentSize","Number","MAX_SAFE_INTEGER","findDOMNode","element","getSelfElement","Element","parent","parentNode","window","HTMLElement","getComputedStyle","position","isMounted","style","e","data","bounds","target","document","querySelector","targetRect","getBoundingClientRect","targetLeft","left","targetTop","top","parentRect","parentLeft","parentTop","offsetWidth","size","width","_freeBottomBounds","offsetHeight","height","newWidth","newHeight","dir","refToElement","stopPropagation","x","draggable","y","self","parentSize","endsWith","ratio","replace","selfRect","selfLeft","selfTop","test","max","direction","refToResizableElement","delta","original","disableDragging","updateSize","snap","moveSnaping","cursorStyle","dragHandleClassName","cursor","innerStyle","React.createElement","default","positionRotate","c","dragAxis","dragGrid","undefined","keyMoveShiftStepLength","extendsProps","className","enableResizing","minWidth","minHeight","resizeGrid","resizeHandleWrapperClass","resizeHandleWrapperStyle","lockAspectRatio","resizeHandleStyles","resizeHandleClasses","children","React","defaultProps"],"mappings":"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"}